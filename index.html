<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
<title>Smethwick LSOA Map</title>

<link rel="stylesheet" href="./resources/ol.css">
<link rel="stylesheet" href="resources/fontawesome-all.min.css">
<link href="resources/photon-geocoder-autocomplete.min.css" rel="stylesheet">
<link rel="stylesheet" href="./resources/ol-layerswitcher.css">
<link rel="stylesheet" href="./resources/qgis2web.css">

<style>
html, body {
    background-color: #ffffff;
    margin: 0;
    height: 100%;
    font-family: Arial, sans-serif;
}

/* Main layout */
.container {
    display: flex;
    height: 100vh;
    gap: 10px;
    padding: 10px;
    box-sizing: border-box;
}

/* Map + title */
.map-wrapper {
    flex: 2;
    display: flex;
    flex-direction: column;
    height: 100%;
    min-width: 600px;
}

/* Title with info icons */
.map-title {
    font-size: 20px;
    font-weight: bold;
    padding: 8px 12px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    gap: 10px;
    position: relative;
    flex-wrap: wrap; /* wrap icons on small screens */
}

.map-title span {
    font-size: 20px; /* all icons same size */
    cursor: pointer;
    padding: 2px 6px;
    border-radius: 4px;
    display: flex;
    align-items: center;
}

/* Individual icon colors */
#info-button { color: #007bff; }
#benefits-button { color: #28a745; }
#attendance-button { color: #ffc107; }
#homechecks-button { color: #6f42c1; } /* purple for home checks */

/* Map container */
#map {
    flex: 1;
    width: 100%;
    min-height: 500px;
}

/* Side image panel - always scrollable */
.side-image {
    flex: 1;
    height: 100%;
    border: 1px solid #ccc;
    padding: 5px;
    background-color: #f8f8f8;

    overflow-y: scroll;
    scrollbar-width: thin;
}

/* Chrome/Edge scrollbar styling */
.side-image::-webkit-scrollbar {
    width: 8px;
}
.side-image::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}
.side-image::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}
.side-image::-webkit-scrollbar-thumb:hover {
    background: #555;
}

/* Image inside side panel */
.side-image img {
    width: 100%;
    height: auto;
    display: block;
}

/* Popup common styling */
.popup-info {
    position: absolute;
    top: 100%;
    left: 0;
    width: 400px;
    max-height: 60vh;
    background: white;
    border: 1px solid #ccc;
    padding: 15px;
    border-radius: 8px;
    overflow-y: auto;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    display: none;
    z-index: 1000;
}

.popup-info button {
    margin-top: 10px;
    padding: 5px 10px;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

/* Specific button colors */
#info-popup button { background-color: #007bff; }
#benefits-popup button { background-color: #28a745; }
#attendance-popup button { background-color: #ffc107; }
#homechecks-popup button { background-color: #6f42c1; }

/* Table color coding */
.info-table th, .info-table td {
    border: 1px solid #ccc;
    padding: 4px;
    text-align: left;
}
.info-table th {
    background-color: #f0f0f0;
}
.info-table td.high { background-color: #f28c8c; }
.info-table td.medium { background-color: #f9e79f; }
.info-table td.low { background-color: #b8e994; }

/* Responsive for small screens */
@media (max-width: 700px) {
    .container {
        flex-direction: column;
    }
    .map-wrapper, .side-image {
        min-width: 100%;
        height: 50vh;
    }
    .popup-info {
        width: 90%;
        left: 5%;
        top: 120%;
    }
}
</style>
</head>
<body>

<div class="container">

    <!-- Map + Title -->
    <div class="map-wrapper">
        <div class="map-title">
            LSOA 28A - Smethwick

            <!-- Info icons -->
            <span id="info-button" title="Click for LSOA 28A Details">IMD2025 i</span>
            <span id="benefits-button" title="Click for Benefits Summary">üí∑</span>
            <span id="attendance-button" title="Click for School Attendance">üéì</span>
            <span id="homechecks-button" title="Click for Home Checks">üè†</span>

            <!-- IMD2025 i Popup -->
            <div id="info-popup" class="popup-info">
                <!-- Full IMD content here (same as before) -->
            </div>

            <!-- Benefits Popup -->
            <div id="benefits-popup" class="popup-info">
                <!-- Full Benefits content here (same as before) -->
            </div>

            <!-- School Attendance Popup -->
            <div id="attendance-popup" class="popup-info">
                <!-- Full School Attendance content here (same as before) -->
            </div>

            <!-- Home Checks Popup -->
            <div id="homechecks-popup" class="popup-info">
                <div id="homechecks-popup-content">
                    <h3>üè† Home Visits ‚Äì Headline Facts</h3>
                    <ol>
                        <li><strong>Total Records:</strong> Total rows with visit data: approximately 150‚Äì160 (excluding placeholder rows and blanks).</li>
                        <li><strong>Visits Within the Last 12 Months:</strong>
                            <ul>
                                <li>YES: Majority of records ‚Äì around 75‚Äì80% of visits flagged as within 12 months.</li>
                                <li>NO: Around 20‚Äì25%, representing older visits (over 365 days ago).</li>
                            </ul>
                        </li>
                        <li><strong>Range of ‚ÄúLast Visit‚Äù (Days Since Last Visit):</strong>
                            <ul>
                                <li>Shortest gap: 22 days (very recent visits).</li>
                                <li>Longest gap: 1,419 days (~3.9 years).</li>
                                <li>Most common range: 200‚Äì700 days (roughly 6 months to 2 years).</li>
                            </ul>
                        </li>
                        <li><strong>Frequent Visit Patterns:</strong>
                            <ul>
                                <li>Multiple records on the same day, suggesting either duplicate entries or multiple visits to the same household.</li>
                                <li>Spikes in visits appear in:
                                    <ul>
                                        <li>End of the year (Nov‚ÄìDec)</li>
                                        <li>Mid-year (June‚ÄìJuly)</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><strong>Older Visits:</strong> Visits beyond 1,000 days (~3 years) are all flagged as NO for 12 months.</li>
                        <li><strong>Key Observations:</strong> Most households are being visited regularly within a year, but a small proportion are long overdue. Some data anomalies exist (future dates, repeated placeholder values, missing dates) that may need cleaning before reporting.</li>
                    </ol>
                </div>
                <button>Close</button>
            </div>

        </div>

        <div id="map">
            <div id="popup" class="ol-popup">
                <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                <div id="popup-content"></div>
            </div>
        </div>
    </div>

    <!-- Side image panel -->
    <div class="side-image">
        <div id="layers-label">ONS Profile</div>
        <img src="Smethwick ONS.png" alt="Smethwick ONS">
    </div>

</div>

<!-- Scripts -->
<script src="resources/qgis2web_expressions.js"></script>
<script src="./resources/functions.js"></script>
<script src="./resources/ol.js"></script>
<script src="./resources/ol-layerswitcher.js"></script>
<script src="resources/photon-geocoder-autocomplete.min.js"></script>

<!-- Map Layers & Styles -->
<script src="layers/SmethwickCanals_0.js"></script>
<script src="layers/LSOA28ASmethwick_1.js"></script>
<script src="layers/SmethwickMetro_2.js"></script>
<script src="layers/RailSmethwickTown_3.js"></script>
<script src="layers/GREENLSOA28ASmethwick_4.js"></script>
<script src="layers/BUSLSOA28ASmethwick_5.js"></script>
<script src="layers/SmethwickBdgs_6.js"></script>
<script src="layers/SmethwickTown_7.js"></script>
<script src="layers/LSOA28AFlyTipping2025_8.js"></script>
<script src="layers/LSOA28ADogMess2025_9.js"></script>
<script src="layers/SmethwickRoads_10.js"></script>
<script src="layers/LLPGLSOA28ASmethwick_11.js"></script>
<script src="layers/BoundayLinesLSOA28A_12.js"></script>
<script src="layers/LSOA28AFlyPostingGraffitti_13.js"></script>
<script src="layers/LSOA28ADangerousLitter_14.js"></script>

<script src="styles/SmethwickCanals_0_style.js"></script>
<script src="styles/LSOA28ASmethwick_1_style.js"></script>
<script src="styles/SmethwickMetro_2_style.js"></script>
<script src="styles/RailSmethwickTown_3_style.js"></script>
<script src="styles/GREENLSOA28ASmethwick_4_style.js"></script>
<script src="styles/BUSLSOA28ASmethwick_5_style.js"></script>
<script src="styles/SmethwickBdgs_6_style.js"></script>
<script src="styles/SmethwickTown_7_style.js"></script>
<script src="styles/LSOA28AFlyTipping2025_8_style.js"></script>
<script src="styles/LSOA28ADogMess2025_9_style.js"></script>
<script src="styles/SmethwickRoads_10_style.js"></script>
<script src="styles/LLPGLSOA28ASmethwick_11_style.js"></script>
<script src="styles/BoundayLinesLSOA28A_12_style.js"></script>
<script src="styles/LSOA28AFlyPostingGraffitti_13_style.js"></script>
<script src="styles/LSOA28ADangerousLitter_14_style.js"></script>

<script src="./layers/layers.js" type="text/javascript"></script> 
<script src="./resources/Autolinker.min.js"></script>
<script src="./resources/qgis2web.js"></script>

<!-- Popup toggle JS -->
<script>
function setupPopup(buttonId, popupId) {
    const button = document.getElementById(buttonId);
    const popup = document.getElementById(popupId);
    const closeBtn = popup.querySelector('button');

    button.addEventListener('click', (e) => {
        e.stopPropagation();
        popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
    });

    closeBtn.addEventListener('click', () => {
        popup.style.display = 'none';
    });

    document.addEventListener('click', (e) => {
        if (!popup.contains(e.target) && e.target !== button) {
            popup.style.display = 'none';
        }
    });
}

// Initialize popups
setupPopup('info-button', 'info-popup');
setupPopup('benefits-button', 'benefits-popup');
setupPopup('attendance-button', 'attendance-popup');
setupPopup('homechecks-button', 'homechecks-popup');
</script>

</body>
</html>


























